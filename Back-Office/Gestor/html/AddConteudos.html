<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Adicionar Conte√∫dos - LABRATS</title>

  <!-- CSS global do back-office -->
  <link rel="stylesheet" href="../css/styleDashboard.css" />
  <link rel="icon" href="../Imagens/Logo.png" type="image/x-icon" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-SP70GQF1B5"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-SP70GQF1B5');
  </script>
</head>

<body>
  <!-- SIDEBAR -->
  <div class="sidebar" style="background-color: #D8ECFF;">
    <div class="logo">
      <img src="../Imagens/Logo.png" alt="LABRATS" />
    </div>
    <nav>
      <ul>
        <li><a href="Geral.html">üè† Vis√£o Geral</a></li>
        <li><a href="Horario.html">üóìÔ∏è Hor√°rio</a></li>
        <li><a href="Alunos.html">üë• Alunos</a></li>
        <li><a class="active" href="Conteudos.html">üìö Conte√∫dos</a></li>
      </ul>
    </nav>
    <div class="add-auditoria">
      <a href="AddConteudos.html">
        <button>+ Adicionar Conte√∫do</button>
      </a>
    </div>
    <div class="user-info">
      <p id="user-name">Vers√£o MVP</p>
      <p id="user-email">Sem e-mail</p>
    </div>
  </div>

  <!-- BACKDROP DO DRAWER (mobile) -->
  <div id="sidebar-backdrop" class="sidebar-backdrop"></div>

  <!-- CONTE√öDO -->
  <div class="content">
    <header class="content-header">
      <button id="menu-toggle" class="menu-toggle" aria-label="Abrir menu">
        <svg viewBox="0 0 24 24" width="24" height="24" stroke="#1f2937" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="6" x2="21" y2="6" />
          <line x1="3" y1="12" x2="21" y2="12" />
          <line x1="3" y1="18" x2="21" y2="18" />
        </svg>
      </button>
      <div>
        <h1>Conte√∫dos</h1>
        <p class="text-muted">Preencha o conte√∫do com as informa√ß√µes necess√°rias.</p>
      </div>
    </header>

    <section class="form-container">
      <div class="form-card">
        <form id="form-auditoria" class="form-auditoria">
          <!-- Detalhes da disciplina -->
          <div class="form-row">
            <div class="form-group">
              <h2 class="section-title">Detalhes da disciplina</h2>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="nome">
                Nome <span style="color: red;" title="Este campo √© obrigat√≥rio">*</span>
              </label>
              <input type="text" id="nome" name="nome" required />
            </div>
          </div>

          <!-- Ano de escolaridade -->
          <div class="form-row">
            <div class="form-group">
              <h2 class="section-title">Ano de Escolaridade</h2>
              <label for="codigo-postal">
                Ano de escolaridade <span style="color: red;" title="Este campo √© obrigat√≥rio">*</span>
              </label>
              <input type="text" id="codigo-postal" name="codigo-postal" required />
            </div>
          </div>

          <!-- Possui data de entrega -->
          <div class="form-row" style="margin-top: 8px;">
            <div class="form-group">
              <label>Possui data de entrega?</label>
              <div class="acordeao-opcoes" style="margin-top: 4px;">
                <input type="radio" id="material-sim" name="material" value="sim" />
                <label for="material-sim">Sim</label>

                <input type="radio" id="material-nao" name="material" value="nao" checked />
                <label for="material-nao">N√£o</label>
              </div>
            </div>
          </div>

          <!-- Dia e hora (mostra/oculta consoante r√°dio) -->
          <div class="form-row data-hora" style="margin-top: 8px;">
            <div class="form-group">
              <h2 class="section-title">Dia e hora</h2>

              <label for="data">
                Data <span style="color: red;" title="Este campo √© obrigat√≥rio">*</span>
              </label>
              <input type="date" id="data" name="data" />

              <label for="hora-inicio">
                In√≠cio <span style="color: red;" title="Este campo √© obrigat√≥rio">*</span>
              </label>
              <input type="time" id="hora-inicio" name="hora-inicio" />

              <label for="tempo-previsto">
                Tempo previsto (horas)
                <span style="color: red;" title="Este campo √© obrigat√≥rio">*</span>
              </label>
              <input
                type="number"
                id="tempo-previsto"
                name="tempo-previsto"
                min="1"
                step="1"
                placeholder="Ex: 2"
              />
            </div>
          </div>

          <!-- Dificuldade -->
          <div class="form-row" style="margin-top: 12px;">
            <div class="form-group">
              <label>Dificuldade do exerc√≠cio:</label>
              <div id="gravidade-container" style="display: flex; gap: 10px; margin-top: 8px;">
                <div class="gravidade-bola" data-valor="1" title="Dificuldade 1" style="width: 24px; height: 24px; border-radius: 50%; background-color: #ddd; cursor: pointer;"></div>
                <div class="gravidade-bola" data-valor="2" title="Dificuldade 2" style="width: 24px; height: 24px; border-radius: 50%; background-color: #ddd; cursor: pointer;"></div>
                <div class="gravidade-bola" data-valor="3" title="Dificuldade 3" style="width: 24px; height: 24px; border-radius: 50%; background-color: #ddd; cursor: pointer;"></div>
                <div class="gravidade-bola" data-valor="4" title="Dificuldade 4" style="width: 24px; height: 24px; border-radius: 50%; background-color: #ddd; cursor: pointer;"></div>
                <div class="gravidade-bola" data-valor="5" title="Dificuldade 5" style="width: 24px; height: 24px; border-radius: 50%; background-color: #ddd; cursor: pointer;"></div>
              </div>
              <input type="hidden" id="gravidade-selecionada" value="1" />
            </div>
          </div>

          <!-- Bot√µes -->
          <div class="form-actions">
            <button type="submit" class="btn-primary">Confirmar</button>
          </div>
        </form>
      </div>
    </section>
  </div>

  <div id="feedback-message" class="feedback-message"></div>

  <script>
    // Drawer (menu lateral em mobile)
    const sidebar = document.querySelector('.sidebar');
    const backdrop = document.getElementById('sidebar-backdrop');
    const menuToggle = document.getElementById('menu-toggle');

    function toggleSidebar() {
      if (!sidebar || !backdrop) return;
      sidebar.classList.toggle('sidebar-open');
      backdrop.classList.toggle('show');
    }

    if (menuToggle) menuToggle.addEventListener('click', toggleSidebar);
    if (backdrop) backdrop.addEventListener('click', toggleSidebar);

    // Atualizar utilizador na sidebar a partir do localStorage
    function atualizarUtilizador() {
      const nome = localStorage.getItem("userName") || "Vers√£o MVP";
      const email = localStorage.getItem("userEmail") || "Sem e-mail";
      const nameEl = document.getElementById("user-name");
      const emailEl = document.getElementById("user-email");
      if (nameEl) nameEl.innerText = nome;
      if (emailEl) emailEl.innerText = email;
    }

    // Sele√ß√£o da gravidade
    const bolas = document.querySelectorAll(".gravidade-bola");
    const inputGravidade = document.getElementById("gravidade-selecionada");

    function atualizarVisualGravidade(valorSelecionado) {
      bolas.forEach(bola => {
        const valor = bola.getAttribute("data-valor");
        if (parseInt(valor) <= valorSelecionado) {
          bola.style.backgroundColor = "#0088FE"; // azul selecionado
        } else {
          bola.style.backgroundColor = "#ddd";    // cinzento
        }
      });
    }

    bolas.forEach(bola => {
      bola.addEventListener("click", () => {
        const valor = parseInt(bola.getAttribute("data-valor"));
        inputGravidade.value = valor;
        atualizarVisualGravidade(valor);
      });
    });

    // Mostrar/ocultar sec√ß√£o "Dia e Hora" conforme escolha em "Possui data de entrega?"
    const materialSim = document.getElementById('material-sim');
    const materialNao = document.getElementById('material-nao');
    const dataHoraSection = document.querySelector('.data-hora');
    const dataInput = document.getElementById('data');
    const horaInicioInput = document.getElementById('hora-inicio');
    const tempoPrevistoInput = document.getElementById('tempo-previsto');

    function toggleMaterialFields() {
      if (materialSim && materialSim.checked) {
        dataHoraSection.style.display = '';
        dataInput.required = true;
        horaInicioInput.required = true;
        tempoPrevistoInput.required = true;
      } else {
        dataHoraSection.style.display = 'none';
        dataInput.required = false;
        horaInicioInput.required = false;
        tempoPrevistoInput.required = false;
        dataInput.value = '';
        horaInicioInput.value = '';
        tempoPrevistoInput.value = '';
      }
    }

    document.addEventListener("DOMContentLoaded", function () {
      atualizarUtilizador();
      toggleMaterialFields();
      if (materialSim && materialNao) {
        materialSim.addEventListener('change', toggleMaterialFields);
        materialNao.addEventListener('change', toggleMaterialFields);
      }

      // gravidade inicia a 1
      atualizarVisualGravidade(1);

      // Submiss√£o do formul√°rio
      const form = document.getElementById('form-auditoria');
      if (form) {
        form.addEventListener('submit', function (e) {
          e.preventDefault();
          if (!form.checkValidity()) {
            form.reportValidity();
            return;
          }
          // aqui podes trocar o redirecionamento se quiseres
          window.location.href = 'promo.html';
        });
      }
    });
  </script>
</body>
</html>
